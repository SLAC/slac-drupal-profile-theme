{# Fields on all publications #}
{{ dd(content) }}
{{ type }}

{% set type = content.field_publication_type|field_value|render %}
{% set author = content.field_authors|field_value|render %}
{% set date = content.field_date|field_value|render %}
{% set doi = content.field_doi|field_value|render %}

{% set title -%}
{{- label|field_value -}}
{%- endset %}

{% set publisher -%}
{{- content.field_publisher|field_value -}}
{%- endset %}

{# Type-specific fields: book #}
{% set place = content.field_publication_place|field_value|render %}

{# Type-specific fields: journal article #}
{% set volume = content.field_volume|field_value|render %}
{% set edition = content.field_edition|field_value|render %}
{% set pages = content.field_pages|field_value|render %}

{# Type-specific fields: thesis #}

{% set citation_content %}

{% if type == 'Article Newspaper/Magazine' %}
  {{- [author, '<b>' ~ title ~ '</b>', '<i>' ~ publisher ~ '</i>', date, '.']|join(', ', '')|raw -}}

{% elseif type == 'Book' %}
  {%- set publication_info -%}
  (
  {{- [publisher, place, date]|join(', ')|raw -}}
  )
  {%- endset -%}
  {{- [author, title, publication_info, '.']|join(', ', '')|raw -}}

{% elseif type == 'Journal Article' %}
  {%- set publication_info -%}
  <i>
    {{- publisher }}
    {{ volume -}}
  </i>
  ,
  {{ pages -}}
  {{ edition }}
  (
  {{- date -}}
  )
  {%- endset %}
  {{- [author, '<b>' ~ title ~ '</b>', publication_info, '.']|join(', ', '')|raw -}}
  {%- if doi %}
    {{ doi }}
  {% endif %}
  {% elseif type == '' %}

{% endif %}
{% endset %}

{% include '@components/citation/citation.twig' with { citation_content: citation_content } %}
